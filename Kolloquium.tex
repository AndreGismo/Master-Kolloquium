%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Präsi für Kolloquium
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[aspectratio=169]{beamer}

\usepackage[ngerman]{babel}
\usepackage{fontspec}
\usepackage{microtype}
\usepackage{selnolig}
\usepackage{csquotes}
\usepackage{amsmath, amssymb}
\usepackage{bm}
\usepackage{soul}
\usepackage{booktabs}
\usepackage{mwe}
\usepackage[style=ieee, backend=biber]{biblatex}
\usepackage{tikz}
\usetikzlibrary{
	positioning,
	calc,
	decorations.shapes,
	decorations.pathmorphing,
	decorations.pathreplacing,
}
\usepackage{listings}


\graphicspath{{img/}}


\addbibresource{refs.bib}


\hypersetup{
	pdfauthor={André Ulrich},
	pdftitle={Kolloquium zur Masterarbeit},
}


\lstset{
	basicstyle=\ttfamily,
	morekeywords={
		{\verb|\begin|},
		\textbackslash end,
		\textbackslash documentclass,
	},
	keywordstyle=\color{blue},
	frame=single,
}


\newcommand*{\param}[1]{$\langle$\textit{\ttfamily #1}$\rangle$}
\newcommand*{\tb}{\textbackslash}

\makeatletter
    \newenvironment{withoutheadline}{
        \setbeamertemplate{headline}[default]
        \def\beamer@entrycode{\vspace*{-\headheight}}
    }{}
\makeatother


\pgfdeclarelayer{background}
\pgfsetlayers{background, main}


\usetheme{frankfurt}
\setbeamertemplate{footline}[frame number]
\setbeamertemplate{navigation symbols}{}


\begin{document}
\author{André Ulrich}
\title{Algorithmus zur optimierten Ladung von Elektrofahrzeugen in einem
gemeinsamen Netzzweig}
\subtitle{Master Kolloquium}
\date{
	\today\bigskip
	
	\begin{tabular}{@{}ll@{}}
	Betreuer: & Prof.\,Dr. Eberhard Waffenschmidt \\
	Ko-Referent: & Prof.\,Dr. Ingo Stadler \\
	\end{tabular}
}
\titlegraphic{
	\pgfputat{\pgfxy(6,0.4)}{
		\includegraphics[scale=0.05]{TH_Koeln_Logo.pdf}
	}
}


\setbeamertemplate{footline}[default]
\begin{withoutheadline}
\begin{frame}[noframenumbering]
	\maketitle
\end{frame}
\end{withoutheadline}


%\setbeamertemplate{footline}[frame number]
\begin{withoutheadline}
\begin{frame}[noframenumbering]{Inhalt}
	\tableofcontents
\end{frame}
\end{withoutheadline}


\section{Hintergrund und Aufgabenstellung}
\setbeamertemplate{footline}[frame number]

\begin{frame}{Hintergrund}
	\begin{itemize}[<+->]
		\item PROGRESSUS-Projekt: weniger Netzüberlastung, mehr BEVs laden
		\cite{noauthor_progressus_nodate}
		\item Entwicklung von Optimierungsalgorithmen zur koordinierten Ladung 
		von BEVs
		\item Bestehende Lösungsansätze:
		\begin{itemize}
			\item GridTopologyEstimation (GTE) zum Bestimmen der Netztopologie
			\item GridStateEstimation (GSE) zum Bestimmen des Netzzustands
		\end{itemize}
		\item \so{ABER:} Bisher nur eingeschränkte Ansätze zur Optimierung
		wie \cite{iserloh2021} oder \cite{koese2022} vorhanden
	\end{itemize}
\end{frame}


\begin{frame}{Hintergrund}
	\begin{figure}
		\centering
		\input{tikz-picz/progressus-overview}
	\end{figure}
\end{frame}


\begin{frame}{Aufgabenstellung}
	\begin{enumerate}[<+->]
		\item Entwicklung eines Optimierungsalgorithmus zur optimalen 
		Koordination der Ladevorgänge von BEVs
		\item Verknüpfung von Optimierung und Simulationsumgebung
		\item Ermöglichen eines parallelen Betriebs von Optimierung und
		Simulationsumgebung
	\end{enumerate}
\end{frame}


\begin{frame}{Aufgabenstellung}
	Der Optimierungsalgorithmus soll:
	\begin{itemize}[<+(1)->]
		\item Zunächst nur einzelne Netzstrahlen betrachten
		\item Netzauslastung maximieren, um möglichst viele BEVs zu laden
		\item Gleichzeitig jedoch Netzüberlastung verhindern
		\item Nach Möglichkeit Diskriminierung beim Laden ausschließen
		\item Automatisch skalieren mit dem betrachteten Netzstrahl
		\item Auch auf einem Raspberry Pi in \enquote{vertretbarer} Zeit 
		ausführbar sein
	\end{itemize}
	
	\onslide<8>{
		\begin{block}{also}
			Einschränkungen bisheriger Arbeiten überwinden und 
			\enquote{Gratwanderung vollführen}.
		\end{block}
	}
\end{frame}

\section{Theorie}

\begin{frame}{Prinzip des Optimierungsalgorithmus}
	\begin{figure}
		\centering
		\input{tikz-picz/input-output-optimization}
	\end{figure}
\end{frame}


\begin{frame}{Optimierung mit Mathematical Programming}
	\begin{columns}
		\begin{column}{.6\textwidth}
			\begin{itemize}
				\item Mathematical Programming als strukturierte 
				Darstellungsweise eines Optimierungsproblems
				\item Beschreibung mithilfe von Zielfunktion und Restriktionen
				\item Formulierug als Linear Programmig
			\end{itemize}
		\end{column}
		\begin{column}{.4\textwidth}
			\begin{align*}
				\begin{split}
		\text{max.}\quad&\sum_{i\in\mathcal{I}}c_i\cdot x_i \\
		\text{s.\,t.}\quad&\sum_{i\in\mathcal{I}}a_{j,i}\cdot x_i\leq b_j\quad
		\forall j\in\mathcal{J} \\
		& x_i\in\mathbb{R}_0^+\quad\forall i\in\mathcal{I}
				\end{split}
			\end{align*}
		\end{column}
	\end{columns}
\end{frame}


\begin{frame}{Formulierung als Linear Programming}
	\begin{description}[<+->]
		\item[Zielfunktion] Maximieren der der Ladeströme an allen Knoten zu 
		jeweils allen Zeitpunkten
		\item[Restriktion] Die Spannung am letzten Knoten darf nicht aus dem
		Spannungsband fallen
		\item[Restriktion] Der Transformator darf nicht überlastet werden
		\item[Restriktion] Keine der Leitungen darf überlastet werden
		\item[Restriktion] Energieerhaltung beim Laden
	\end{description}
	\onslide<6>{
		\begin{block}{$\dots$ und außerdem:}
			4 Weitere Restriktionen für \enquote{faires} Laden
		\end{block}
	}
\end{frame}


\begin{frame}{Rolling Horizon für große Optimierungsprobleme}
	\begin{itemize}[<+->]
		\item Großer Zeithorizont, zu dem ein großes Optimierungsproblem
		korrespondiert
		\item Großen Zeithorizont zerlegen in mehrere kleine Horizonte
		\item Die zu den einzelnen Horizonten korrespondierenden 
		Optimierungsprobleme lösen
		\item Die Gesamtlösung ergibt sich aus den einzelnen Teillösungen
	\end{itemize}
\end{frame}


\begin{frame}{Rolling Horizon für große Optimierungsprobleme}
	\begin{figure}
		\centering
		\include{tikz-picz/rolling-horizon-scheme}
	\end{figure}
\end{frame}


\section{Praktische Umsetzung}

\begin{frame}{Optimierungsprobleme mit Python lösen}
	\begin{itemize}
		\item Python als Programmiersprache
		\item Pyomo als Optimierungsframework
		\item glpk als Solver
	\end{itemize}
\end{frame}


\begin{frame}{Aufbau der Software zur Optimierung}
	Mehrere Klassen:
	\begin{itemize}[<+(1)->]
		\item Eigene Klasse \texttt{GridLineOptimizer} für Netzstrahl und 
		Logik der Optimierung
		\item Eigene Klasse \texttt{BatteryElectricVehicle} für BEVs
		\item Eigene Klasse \texttt{Household} für Haushaltslasten
	\end{itemize}
	
	\onslide<5->{
		\begin{block}{Modularer Aufbau}
			Bessere Wartbarkeit und Portabilität
		\end{block}
	}
\end{frame}


\begin{frame}{Funktionsprinzip der Software zur Optimierung}
	\begin{figure}
		\centering
		\input{tikz-picz/software-principle}
	\end{figure}
\end{frame}


\section{Ergebnisse}

\begin{frame}{Untersuchung anhand von Szenarien}
	\begin{itemize}[<+->]
		\item Definieren unterschiedlicher Szenarien
		\begin{itemize}
			\item Transformatorleistung
			\item Anzahl Knoten
			\item Position der Ladesäulen
			\item $\dots$
		\end{itemize}
		\item Optimierung ausführen
		\item Ergebnisse mithilfe der Simulationsumgebung validieren
	\end{itemize}
\end{frame}


\section{Fazit}

\begin{frame}{Fazit}
	bla bla
\end{frame}


\begin{frame}{Literatur}
	\printbibliography
\end{frame}


\begin{frame}{Formulierung als Linear Programming}
	Die Zielfunktion: Maximieren der Ladeströme zu allen Zeitpunkten
	\begin{equation*}
		\text{max.}\quad\sum_{t\in\mathcal{T}}\bigg(\sum_{n\in
		\mathcal{N_\mathsf{BEV}}}\!\!I^\mathsf{BEV}_{t,n}\bigg)
	\end{equation*}
\end{frame}

\end{document}